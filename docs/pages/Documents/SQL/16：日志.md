# 日志

## 错误日志

见名知义，错误日志存放的是数据库在开始，结束，运行过程中出现错误时，记录相关信息的日志，如果数据库出现错误，停止运行，崩溃，建议首先查看错误日志。

```mysql
# 存放目录：/var/log/mysqlld.log
# 查看指令：
show variables like '%log_error%';
# 查看之后，log_error之后记录的是错误日志的路径
```

---

## 二进制日志

二进制日志记录了所有的DDL，DML语句，不包括查询语句，
简单来说，包含的就是对库表的修改，元数据的修改，数据内容的修改
在MySQL8.x版本，二进制日志默认开启

#### 作用：

1：灾难的数据恢复
2：主从复制

```mysql
# 查看二进制日志参数\
show variables like '%log_bin%';
# log_bin 是否开启
# log_bin_basename 文件位置，文件名
# log_bin_index 日志索引文件
...
```

#### 格式

二进制日志可以有多种记录方式：![](https://banxia-log.oss-cn-beijing.aliyuncs.com/MySQL/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97%E7%9A%84%E6%A0%BC%E5%BC%8F.png)

```mysql
# 查询参数方式
show variables like '%binlog_format%';
```

![](https://banxia-log.oss-cn-beijing.aliyuncs.com/MySQL/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97%E6%9F%A5%E7%9C%8B%E6%96%B9%E5%BC%8F.png)

那么问题就来了：二进制日志太多，时间线太长，怎么办：我们可以删除

![](https://banxia-log.oss-cn-beijing.aliyuncs.com/MySQL/%E5%88%A0%E9%99%A4%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97%E6%96%B9%E5%BC%8F.png)

---

## 查询日志

二进制日志中包含的是DML和DDL语句，查询日志包含所有的语句
由于记录语句太多，查询语句一般不默认开启，要手动开启

```mysql
# 查看参数
show variables like '%general%';
```

开启方法：![](https://banxia-log.oss-cn-beijing.aliyuncs.com/MySQL/%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97%E5%BC%80%E5%90%AF%E6%96%B9%E6%B3%95.png)

---

## 慢查询日志

之前了解过，指的是记录那些超过预定耗时的语句，所以叫慢查询日志。默认不开启

开启：![](https://banxia-log.oss-cn-beijing.aliyuncs.com/MySQL/%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97%E5%BC%80%E5%90%AF%E6%96%B9%E6%B3%95.png)

默认情况下，慢查询日志不会记录管理语句，也不会记录不使用索引的语句，但是可以开启：![](https://banxia-log.oss-cn-beijing.aliyuncs.com/MySQL/%E5%A6%82%E4%BD%95%E6%9B%B4%E6%94%B9%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97%E7%9A%84%E8%AE%B0%E5%BD%95%E8%A7%84%E5%88%99.png)

# 