# 主从复制

## 概述

将主库的二进制日志导出，写入一个新的数据库，就是主从复制，提供二进制日志的数据库叫做主库，接受二进制日志的叫做从库

### 作用：

1：主库出现问题，可以切换到从库进行服务
2：实现读写分离，降低主库压力
3：可以在从库中进行备份，避免备份期间影响服务

---

## 原理

主从复制的原理是基于二进制日志（binlog）

首先，主库会导出一份binlog，以供从库接收
然后，从库会创建IOThread，用于发送请求，读取主库导出的binlog，并写入到一份中继日志（Relay log）中
然后，从库会创建SQLThread 用于将中继日志的信息写入到数据库中

## 搭建

首先，搭建需要两台服务器。一台搭载主库，一台搭载从库
然后，需要关闭两台服务器的防火墙或者开放指定端口![](https://banxia-log.oss-cn-beijing.aliyuncs.com/MySQL/%E5%BC%80%E6%94%BE%E7%AB%AF%E5%8F%A3%E5%92%8C%E5%85%B3%E9%97%AD%E9%98%B2%E7%81%AB%E5%A2%99.png)
然后，配置主库：修改文件：![主库配置](https://banxia-log.oss-cn-beijing.aliyuncs.com/MySQL/%E4%B8%BB%E5%BA%93%E9%85%8D%E7%BD%AE.png)
然后：配置主库：创建账户：![](https://banxia-log.oss-cn-beijing.aliyuncs.com/MySQL/%E5%88%9B%E5%BB%BA%E4%B8%BB%E5%BA%93%E8%B4%A6%E6%88%B7.png)
然后：查看主库二进制日志坐标：![](https://banxia-log.oss-cn-beijing.aliyuncs.com/MySQL/%E4%B8%BB%E5%BA%93%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97%E5%9D%90%E6%A0%87.png)
然后：修改从库文件：![](https://banxia-log.oss-cn-beijing.aliyuncs.com/MySQL/%E4%BB%8E%E5%BA%93%E6%96%87%E4%BB%B6%E4%BF%AE%E6%94%B9.png)如果想禁用超级管理员权限，需要加入：super_read_only=1
然后，在从库设置主库配置：![](https://banxia-log.oss-cn-beijing.aliyuncs.com/MySQL/%E4%BB%8E%E5%BA%93%E9%85%8D%E7%BD%AE.png)
然后：开启从库同步操作：|
![](https://banxia-log.oss-cn-beijing.aliyuncs.com/MySQL/%E4%BB%8E%E5%BA%93%E5%BC%80%E5%90%AF%E6%93%8D%E4%BD%9C.png)
然后：还可以检查从库状态：
![](https://banxia-log.oss-cn-beijing.aliyuncs.com/MySQL/%E4%BB%8E%E5%BA%93%E5%90%8C%E6%AD%A5%E7%8A%B6%E6%80%81.png)

---

# 