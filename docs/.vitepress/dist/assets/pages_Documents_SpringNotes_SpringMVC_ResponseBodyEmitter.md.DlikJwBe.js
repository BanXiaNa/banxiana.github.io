import{_ as i,c as a,o as t,aj as e}from"./chunks/framework.iQ8U7nGd.js";const E=JSON.parse('{"title":"ResponseBodyEmitter ä½¿ç”¨æŒ‡å—","description":"","frontmatter":{},"headers":[],"relativePath":"pages/Documents/SpringNotes/SpringMVC/ResponseBodyEmitter.md","filePath":"pages/Documents/SpringNotes/SpringMVC/ResponseBodyEmitter.md","lastUpdated":0}'),n={name:"pages/Documents/SpringNotes/SpringMVC/ResponseBodyEmitter.md"};function l(h,s,r,p,k,d){return t(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="responsebodyemitter-ä½¿ç”¨æŒ‡å—" tabindex="-1">ResponseBodyEmitter ä½¿ç”¨æŒ‡å— <a class="header-anchor" href="#responsebodyemitter-ä½¿ç”¨æŒ‡å—" aria-label="Permalink to â€œResponseBodyEmitter ä½¿ç”¨æŒ‡å—â€">â€‹</a></h1><p><a href="https://spring.io/" target="_blank" rel="noreferrer"><img src="https://img.shields.io/badge/Spring-%E6%A1%86%E6%9E%B6-6DB33F?style=flat-square&amp;logo=spring&amp;logoColor=white" alt="Spring"></a><a href="https://www.java.com/" target="_blank" rel="noreferrer"><img src="https://img.shields.io/badge/Java-%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80-ED8B00?style=flat-square&amp;logo=java&amp;logoColor=white" alt="Java"></a></p><h2 id="ğŸ“–-å‰è¨€" tabindex="-1">ğŸ“– å‰è¨€ <a class="header-anchor" href="#ğŸ“–-å‰è¨€" aria-label="Permalink to â€œğŸ“– å‰è¨€â€">â€‹</a></h2><p>æœ€è¿‘åœ¨å­¦ä¹  AI Agent å¼€å‘ï¼Œåœ¨å‰åç«¯æ•°æ®äº¤äº’çš„æ—¶å€™é‡åˆ°è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœä½¿ç”¨è€…å‘ AI å‘é€ä¸€æ®µæç¤ºè¯ï¼ŒAI é€šå¸¸çš„å¤„ç†å®Œæ¯•çš„è€—æ—¶ä¼šæ¯”è¾ƒé•¿ï¼Œå› ä¸ºä»–æ˜¯æµå¼è¾“å‡ºçš„ï¼Œè¿™æ—¶å€™ï¼Œå‰ç«¯åªèƒ½é™æ‚„æ‚„çš„ç­‰å¾…ï¼Œç»™ä½¿ç”¨è€…å¸¦æ¥çš„ä½“éªŒå°±ä¸æ˜¯å¾ˆç¾å¦™ã€‚æ¯•ç«Ÿï¼Œåœ¨ä½ è®²å®Œè¯ä¹‹åï¼Œå¯¹é¢é™æ‚„æ‚„çš„ï¼Œè·Ÿæ­»äº†ä¸€æ ·ï¼Œè‚¯å®šä¸æ˜¯å¾ˆç¾å¦™äº†ï¼Œæˆ‘ä»¬éœ€è¦ç›¸å¯¹åº”çš„æµå¼äº¤äº’æ–¹å¼æ¥è§£å†³è¿™ä¸€ç‚¹ï¼Œåç«¯çš„ AI äº§ç”Ÿä¸€ç‚¹å†…å®¹å°±å‘å‰ç«¯è¾“å‡ºä¸€ç‚¹å†…å®¹ï¼Œè¿™æ ·å°±æ¯”è¾ƒç¾å¦™äº†ã€‚</p><hr><h2 id="ğŸ¯-è§£å†³é—®é¢˜" tabindex="-1">ğŸ¯ è§£å†³é—®é¢˜ <a class="header-anchor" href="#ğŸ¯-è§£å†³é—®é¢˜" aria-label="Permalink to â€œğŸ¯ è§£å†³é—®é¢˜â€">â€‹</a></h2><p>é€‚åˆè€—æ—¶æ¯”è¾ƒé•¿çš„ä»»åŠ¡æˆ–è€…æ˜¯ä¼šæŒç»­è¾“å‡ºå†…å®¹çš„ä»»åŠ¡ï¼Œæ¯”å¦‚ä¸‹è½½è¿›åº¦ã€å®æ—¶æ—¥å¿—ã€å¤§æ•°æ®é‡åˆ†ç‰‡åŠ è½½ç­‰ç­‰ã€‚</p><p><strong>ResponseBodyEmitter</strong>ï¼šæ˜¯ Spring MVCï¼ˆä» 4.2 ç‰ˆæœ¬å¼•å…¥ï¼‰æä¾›çš„ä¸€ä¸ªå·¥å…·ï¼Œç”¨äº<strong>å¼‚æ­¥ã€åˆ†æ®µåœ°å‘å®¢æˆ·ç«¯å‘é€æ•°æ®</strong></p><p><strong>ç‰¹ç‚¹ï¼š</strong></p><ul><li><strong>ä¸é˜»å¡æœåŠ¡å™¨çº¿ç¨‹</strong>ï¼šåœ¨æ•°æ®å‡†å¤‡å¥½ä¹‹å‰ï¼Œé‡Šæ”¾å®¹å™¨çº¿ç¨‹å»å¤„ç†å…¶ä»–è¯·æ±‚</li><li><strong>æµå¼è¾“å‡º</strong>ï¼šæ•°æ®äº§ç”Ÿä¸€ç‚¹ï¼Œå°±å‘ç»™å®¢æˆ·ç«¯ä¸€ç‚¹</li></ul><p>éå¸¸ç¾å¦™...</p><hr><h2 id="ğŸ’¡-ç®€å•ç¤ºä¾‹" tabindex="-1">ğŸ’¡ ç®€å•ç¤ºä¾‹ <a class="header-anchor" href="#ğŸ’¡-ç®€å•ç¤ºä¾‹" aria-label="Permalink to â€œğŸ’¡ ç®€å•ç¤ºä¾‹â€">â€‹</a></h2><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GetMapping</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/stream&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ResponseBodyEmitter </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">handle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 1. åˆ›å»ºä¸€ä¸ªå‘å°„å™¨ï¼ˆå¯ä»¥è®¾ç½®è¶…æ—¶æ—¶é—´ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ResponseBodyEmitter emitter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ResponseBodyEmitter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 2. å¯åŠ¨å¼‚æ­¥çº¿ç¨‹å‘é€æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Executors.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">newSingleThreadExecutor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                Thread.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sleep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // å‘é€æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                emitter.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ç¬¬ &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot; æ‰¹æ•°æ®åŒ…</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // 3. å…¨éƒ¨å‘é€å®Œæˆ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            emitter.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">complete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Exception </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">e</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            emitter.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">completeWithError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> emitter;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿”å› <code>ResponseBodyEmitter</code> å¯¹è±¡ï¼Œç„¶åï¼Œæ¥å—è€…å’Œå‘é€è€…ä¹‹é—´åƒæ˜¯å»ºç«‹äº†ä¸€ä¸ªç®¡é“ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥è®©å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨åˆ›å»ºå¥½çš„è¿™ä¸ªå¯¹è±¡å¯ä»¥å‘é€æ•°æ®ï¼Œå¦ä¸€ç«¯ä¼šé€æ­¥çš„æ¥æ”¶æ•°æ®ï¼Œç›´åˆ°é€šé“å…³é—­ã€‚</p><hr><h2 id="ğŸ“š-åŸºæœ¬ç”¨æ³•" tabindex="-1">ğŸ“š åŸºæœ¬ç”¨æ³• <a class="header-anchor" href="#ğŸ“š-åŸºæœ¬ç”¨æ³•" aria-label="Permalink to â€œğŸ“š åŸºæœ¬ç”¨æ³•â€">â€‹</a></h2><p><strong>æ–‡æ¡£è¯¦è§ï¼š</strong> <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/mvc/method/annotation/ResponseBodyEmitter.html" target="_blank" rel="noreferrer">ResponseBodyEmitter (Spring Framework 7.0.3 API)</a></p><h3 id="æ„é€ æ–¹æ³•" tabindex="-1">æ„é€ æ–¹æ³• <a class="header-anchor" href="#æ„é€ æ–¹æ³•" aria-label="Permalink to â€œæ„é€ æ–¹æ³•â€">â€‹</a></h3><ul><li><code>ResponseBodyEmitter()</code> - å¸¸ç”¨</li><li><code>ResponseBodyEmitter(Long timeout)</code> - è®¾ç½®è¶…æ—¶æ—¶é—´</li></ul><h3 id="å¸¸ç”¨æ–¹æ³•" tabindex="-1">å¸¸ç”¨æ–¹æ³• <a class="header-anchor" href="#å¸¸ç”¨æ–¹æ³•" aria-label="Permalink to â€œå¸¸ç”¨æ–¹æ³•â€">â€‹</a></h3><ul><li><code>send(Object data)</code> - å‘å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼Œå¯ä»¥å¤šæ¬¡è°ƒç”¨</li><li><code>complete()</code> - ç»“æŸå“åº”æµï¼Œè¡¨ç¤ºæ•°æ®å‘é€å®Œæ¯•</li><li><code>onTimeout(Runnable callback)</code> - è®¾ç½®è¶…æ—¶å›è°ƒå‡½æ•°</li><li><code>onCompletion(Runnable callback)</code> - è®¾ç½®å®Œæˆå›è°ƒå‡½æ•°</li></ul><hr><h2 id="ğŸ”§-å·¥ä½œåŸç†" tabindex="-1">ğŸ”§ å·¥ä½œåŸç† <a class="header-anchor" href="#ğŸ”§-å·¥ä½œåŸç†" aria-label="Permalink to â€œğŸ”§ å·¥ä½œåŸç†â€">â€‹</a></h2><ol><li><p><strong>æ§åˆ¶å™¨è¿”å›å¯¹è±¡</strong>ï¼šController ä¸å†è¿”å›æ™®é€šçš„ <code>String</code> æˆ– <code>ResponseEntity</code>ï¼Œè€Œæ˜¯ç›´æ¥è¿”å› <code>ResponseBodyEmitter</code> å®ä¾‹</p></li><li><p><strong>å¥æŸ„æŒæœ‰</strong>ï¼šSpring ä¼šä¿æŒè¿™ä¸ª HTTP è¿æ¥å¼€å¯</p></li><li><p><strong>å¼‚æ­¥å‘é€</strong>ï¼šä½ å¯ä»¥æŠŠè¿™ä¸ª <code>emitter</code> ä¸¢ç»™å¦ä¸€ä¸ªå¼‚æ­¥çº¿ç¨‹ã€‚é‚£ä¸ªçº¿ç¨‹åªè¦è°ƒç”¨ <code>emitter.send(data)</code>ï¼Œæ•°æ®å°±ä¼šè¢«æ¨é€åˆ°å®¢æˆ·ç«¯</p></li><li><p><strong>å®Œæˆæˆ–è¶…æ—¶</strong>ï¼šè°ƒç”¨ <code>emitter.complete()</code> å…³é—­è¿æ¥ï¼Œæˆ–è€…å› ä¸ºè¶…æ—¶è‡ªåŠ¨æ–­å¼€</p></li></ol><hr><h2 id="âš ï¸-æ³¨æ„äº‹é¡¹" tabindex="-1">âš ï¸ æ³¨æ„äº‹é¡¹ <a class="header-anchor" href="#âš ï¸-æ³¨æ„äº‹é¡¹" aria-label="Permalink to â€œâš ï¸ æ³¨æ„äº‹é¡¹â€">â€‹</a></h2><ul><li><strong>èµ„æºé‡Šæ”¾</strong>ï¼šæ³¨æ„ç”¨å®Œå°±ä¸¢æ‰æˆ–è€…ç›´æ¥è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œè¶…æ—¶å°±å…³é—­</li><li><strong>çº¿ç¨‹å®‰å…¨</strong>ï¼š<code>send()</code> æ–¹æ³•æ˜¯çº¿ç¨‹å®‰å…¨çš„</li></ul><hr><h2 id="ğŸ”„-ç›¸å…³å·¥å…·å¯¹æ¯”" tabindex="-1">ğŸ”„ ç›¸å…³å·¥å…·å¯¹æ¯” <a class="header-anchor" href="#ğŸ”„-ç›¸å…³å·¥å…·å¯¹æ¯”" aria-label="Permalink to â€œğŸ”„ ç›¸å…³å·¥å…·å¯¹æ¯”â€">â€‹</a></h2><p>åœ¨ Spring ä¸­ï¼Œä½ å¯èƒ½è¿˜ä¼šçœ‹åˆ°å¦å¤–ä¸¤ä¸ªé•¿å¾—å¾ˆåƒçš„ä¸œè¥¿ï¼š</p><table tabindex="0"><thead><tr><th>å·¥å…·</th><th>ç‰¹ç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>ResponseBodyEmitter</strong></td><td>é€šç”¨çš„å¼‚æ­¥æµ</td><td>çµæ´»åœ°å‘é€ä»»ä½•å¯¹è±¡ï¼ŒSpring ä¼šç”¨ HttpMessageConverter è½¬æˆ JSON ç­‰</td></tr><tr><td><strong>SseEmitter</strong></td><td>ç»§æ‰¿è‡ªä¸Šé¢é‚£ä½ï¼Œä¸“é—¨ç”¨äº <strong>Server-Sent Events (SSE)</strong></td><td>æµè§ˆå™¨ç«¯çš„å®æ—¶æ¨é€ï¼ˆç±»ä¼¼å•å‘ WebSocketï¼‰</td></tr><tr><td><strong>StreamingResponseBody</strong></td><td>æ€§èƒ½æ›´é«˜ï¼Œç›´æ¥æ“ä½œ <code>OutputStream</code></td><td>é€‚åˆå‘é€å¤§æ–‡ä»¶æˆ–çº¯æ–‡æœ¬æµ</td></tr></tbody></table><hr><h2 id="ğŸ‘‹-æ€»ç»“" tabindex="-1">ğŸ‘‹ æ€»ç»“ <a class="header-anchor" href="#ğŸ‘‹-æ€»ç»“" aria-label="Permalink to â€œğŸ‘‹ æ€»ç»“â€">â€‹</a></h2><p>ResponseBodyEmitter æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„å·¥å…·ï¼Œç‰¹åˆ«é€‚åˆéœ€è¦æµå¼è¾“å‡ºçš„åœºæ™¯ã€‚é€šè¿‡å¼‚æ­¥å‘é€æ•°æ®ï¼Œå¯ä»¥å¤§å¤§æå‡ç”¨æˆ·ä½“éªŒï¼Œé¿å…é•¿æ—¶é—´ç­‰å¾…çš„å°´å°¬ã€‚</p><p>æ°æ°~</p>`,36)])])}const g=i(n,[["render",l]]);export{E as __pageData,g as default};
