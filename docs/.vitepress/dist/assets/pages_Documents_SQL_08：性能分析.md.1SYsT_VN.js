import{_ as s,c as e,o as i,aj as l}from"./chunks/framework.iQ8U7nGd.js";const g=JSON.parse('{"title":"性能分析","description":"","frontmatter":{},"headers":[],"relativePath":"pages/Documents/SQL/08：性能分析.md","filePath":"pages/Documents/SQL/08：性能分析.md","lastUpdated":1770565939000}'),t={name:"pages/Documents/SQL/08：性能分析.md"};function n(r,a,h,o,p,d){return i(),e("div",null,[...a[0]||(a[0]=[l(`<h1 id="性能分析" tabindex="-1">性能分析 <a class="header-anchor" href="#性能分析" aria-label="Permalink to “性能分析”">​</a></h1><h2 id="查询sql语句使用频率" tabindex="-1">查询SQL语句使用频率 <a class="header-anchor" href="#查询sql语句使用频率" aria-label="Permalink to “查询SQL语句使用频率”">​</a></h2><div class="language-mysql"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>show [global | session] status like &#39;com_______&#39;;</span></span></code></pre></div><p><strong>globle</strong>：全局 <strong>session</strong>：当前会话</p><hr><h2 id="慢查询日志" tabindex="-1">慢查询日志 <a class="header-anchor" href="#慢查询日志" aria-label="Permalink to “慢查询日志”">​</a></h2><p>对于那些超过了指定默认运行时间的指令，SQL会记录到慢查询日志中，通过查询这个日志，我们可以针对性的对其进行头花</p><h3 id="查看慢查询日志是否打开" tabindex="-1">查看慢查询日志是否打开 <a class="header-anchor" href="#查看慢查询日志是否打开" aria-label="Permalink to “查看慢查询日志是否打开”">​</a></h3><div class="language-mysql"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>show variables like &#39;slow_query_log&#39;;</span></span></code></pre></div><h3 id="打开日志" tabindex="-1">打开日志 <a class="header-anchor" href="#打开日志" aria-label="Permalink to “打开日志”">​</a></h3><p>/etc/my.cnf文件下添加</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span># 慢查询日志开启</span></span>
<span class="line"><span>low_query_log=1</span></span>
<span class="line"><span># 设置超时时间</span></span>
<span class="line"><span>long_query_time=2</span></span></code></pre></div><p>日志名称：localhost-show.log</p><hr><h2 id="profile" tabindex="-1">Profile <a class="header-anchor" href="#profile" aria-label="Permalink to “Profile”">​</a></h2><p>慢查询日志只能记录超过限定时间的SQL，不能查询所有语句的耗时，Profile就可以满足</p><h3 id="查看是否支持profile操作" tabindex="-1">查看是否支持profile操作 <a class="header-anchor" href="#查看是否支持profile操作" aria-label="Permalink to “查看是否支持profile操作”">​</a></h3><div class="language-mysql"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>select @@have_profiling;</span></span></code></pre></div><hr><h3 id="查看是否开启" tabindex="-1">查看是否开启 <a class="header-anchor" href="#查看是否开启" aria-label="Permalink to “查看是否开启”">​</a></h3><div class="language-mysql"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>select @@profiling;</span></span></code></pre></div><hr><h3 id="开启profile" tabindex="-1">开启profile <a class="header-anchor" href="#开启profile" aria-label="Permalink to “开启profile”">​</a></h3><div class="language-mysql"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>set [session | global] profiling = 1;</span></span></code></pre></div><p><strong>session</strong>：当前会话 <strong>global</strong>：全局会话</p><hr><h3 id="查看profile" tabindex="-1">查看profile <a class="header-anchor" href="#查看profile" aria-label="Permalink to “查看profile”">​</a></h3><div class="language-mysql"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>show profiles;</span></span></code></pre></div><hr><h3 id="查看指定语句耗时" tabindex="-1">查看指定语句耗时 <a class="header-anchor" href="#查看指定语句耗时" aria-label="Permalink to “查看指定语句耗时”">​</a></h3><p>里面有各种阶段的耗时，可以通过这个进行更加细节的优化</p><div class="language-mysql"><button title="Copy Code" class="copy"></button><span class="lang">mysql</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>show profile cpu for query query_id;</span></span></code></pre></div><hr><h2 id="explain执行计划" tabindex="-1">explain执行计划 <a class="header-anchor" href="#explain执行计划" aria-label="Permalink to “explain执行计划”">​</a></h2><p>可以查看select执行过程中的细节</p><h3 id="调用" tabindex="-1">调用 <a class="header-anchor" href="#调用" aria-label="Permalink to “调用”">​</a></h3><p>在任意的查询语句之前加上 desc | explain 就可以查看该语句的执行计划</p><h3 id="字段含义" tabindex="-1">字段含义 <a class="header-anchor" href="#字段含义" aria-label="Permalink to “字段含义”">​</a></h3><p><strong>ID</strong>：查询序号，执行查询语句的执行循序，ID相同，从上到下，ID不同，值越大越先执行 <strong>select_type</strong>：查询类型。意义不大，可以自行搜索 <strong>type</strong>：连接类型：性能由好到差依次是：null，system，Const，eq_ref，ref，range，Index，All 在优化中，我们一般想要连接类型尽量靠前 <strong>possible_key</strong>：可能用到的索引 <strong>key</strong>：实际使用的索引 <strong>key_len</strong>：索引使用的字节数目 <strong>rows</strong>：可能要查询的行数 <strong>filtered</strong>：返回行数占据查询行数的百分比 <strong>extra</strong>：额外信息</p><h1 id="" tabindex="-1"><a class="header-anchor" href="#" aria-label="Permalink to “”">​</a></h1>`,40)])])}const k=s(t,[["render",n]]);export{g as __pageData,k as default};
